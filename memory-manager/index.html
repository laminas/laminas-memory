<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Manage data in an environment with limited memory">  
    <link rel="canonical" href="https://docs.laminas.dev/laminas-memory/memory-manager/">
    <link rel="shortcut icon" href="/img/trademark-laminas-foundation-rgb.svg">

    <title>Memory Manager - laminas-memory - Laminas Docs</title>

    <link rel="stylesheet" href="https://docs.laminas.dev/css/styles.css">
</head>
<body id="page-top" class="components">

    
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        
        <a class="logo-link navbar-brand offset-md-2" href="https://getlaminas.org/" data-tooltip data-placement="bottom" title="Go to the Laminas homepage">
            <img src="../img/laminas-foundation-white.svg" height="28" alt="Laminas">
        </a>
        <a class="navbar-title" href="https://docs.laminas.dev/" data-tooltip data-placement="bottom" title="Go to the Laminas Documentation">
            Documentation
        </a>

        
        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div class="dropdown">
                        <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false">
                            All Docs
                        </a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="https://docs.laminas.dev/components">Components</a>
                            <a class="dropdown-item" href="https://docs.mezzio.dev/">Mezzio</a>
                            <a class="dropdown-item" href="https://api-tools.getlaminas.org/docs">API Tools</a>
                            <a class="dropdown-item" href="https://docs.laminas.dev/mvc">MVC</a>
                        </div>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="https://getlaminas.org/participate" class="nav-link">Community</a>
                </li>
            </ul>

            
            
                <div class="d-block d-sm-none">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">laminas-memory</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../intro/" class="subnavigation__link">Introduction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Reference</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Memory Manager</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../memory-objects/" class="subnavigation__link">Memory Objects</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="d-block d-sm-none">
                <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</nav>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-6 offset-md-2">
                <h1 class="header__title">
                    Components

                    
                        <small class="header__subtitle">laminas-memory</small>
                    
                </h1>
            </div>

            
            <div class="col-4 text-sm-right">
                
                    

                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/laminas/laminas-memory/" class="header__link header__link--github" title="Go to repository of laminas-memory">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-2 col-sm-12">
                
                
                    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">On this page</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#creating-a-memory-manager" class="toc__link">Creating a Memory Manager</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#managing-memory-objects" class="toc__link">Managing Memory Objects</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#settings" class="toc__link">Settings</a>
                    </li>
                
            </ul>
        </div>
    

                
            </div>
            <div class="col-md-7 col-sm-12 content" role="main" data-spy="scroll" data-target=".toc">
                
                    <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/">Overview</a></li>
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/components/">Components</a></li>

            
                <li class="breadcrumb-item"><a href="..">laminas-memory</a></li>

                
                    
                        
                        
                            <li class="breadcrumb-item">Reference</li>
                        
                    
                

                <li class="breadcrumb-item active" aria-current="page">Memory Manager</li>
            
        
    </ol>
</nav>






    
    
        <h2 class="chapter__headline">Reference</h2>
    

    <h1 id="memory-manager">Memory Manager</h1>
<h2 id="creating-a-memory-manager">Creating a Memory Manager</h2>
<p>You can create new a memory manager (<code>Laminas\Memory\MemoryManager</code> object) using its constructor:</p>
<pre class=codehilite><code class=language-php>__construct(Laminas\Cache\Storage\StorageInterface $cache = null) : void</code></pre>
<p>As an example, the following creates an instance which <em>is not</em> backed by cache
storage:</p>
<pre class=codehilite><code class=language-php>$memoryManager = new Laminas\Memory\MemoryManager();</code></pre>
<p>While the following creates an instance backed by a filesystem cache storage
adapter, storing memory blocks in the <code>tmp/</code> directory of the current working
directory:</p>
<pre class=codehilite><code class=language-php>use Laminas\Cache\StorageFactory;
use Laminas\Memory\MemoryManager;

$cache = StorageFactory::factory([
    'adapter' =&gt; [
        'name' =&gt; 'Filesystem',
        'options' =&gt; [
            'cache_dir' =&gt; './tmp/', // Directory in which to put swapped memory blocks
        ],
    ],
]);

$memoryManager = new MemoryManager($cache);</code></pre>
<p>The <code>MemoryManager</code> uses <a href="http://docs.laminas.dev/laminas-cache/storage/adapter/">laminas-cache storage adapters</a>
to cache memory blocks; if no cache instance is provided, the system temporary
directory is used. This is useful if you know that memory is not limited or the
overall size of objects never reaches the memory limit.</p>
<h2 id="managing-memory-objects">Managing Memory Objects</h2>
<p>This section describes creating and destroying objects in the managed memory,
and settings to control memory manager behavior.</p>
<h3>Creating Movable Objects</h3>
<p>Create movable objects (objects which may be swapped into cache storage) using
the <code>Laminas\Memory\MemoryManager::create([$data])</code> method:</p>
<pre class=codehilite><code class=language-php>$memObject = $memoryManager-&gt;create($data);</code></pre>
<p>The <code>$data</code> argument is optional and used to initialize the object value. If the
<code>$data</code> argument is omitted, the value is an empty string.</p>
<h3>Creating Locked Objects</h3>
<p>Create locked objects (objects which will never be swapped into cache storage)
using the <code>Laminas\Memory\MemoryManager::createLocked([$data])</code> method:</p>
<pre class=codehilite><code class=language-php>$memObject = $memoryManager-&gt;createLocked($data);</code></pre>
<p>The <code>$data</code> argument is optional and used to initialize the object value. If the
<code>$data</code> argument is omitted, the value is an empty string.</p>
<h3>Destroying Objects</h3>
<p>Memory objects are automatically destroyed and removed from memory when they go
out of scope:</p>
<pre class=codehilite><code class=language-php>function foo() use ($memoryManager, $memList) {
    // ...

    $memObject1 = $memoryManager-&gt;create($data1);
    $memObject2 = $memoryManager-&gt;create($data2);
    $memObject3 = $memoryManager-&gt;create($data3);

    // ...

    $memList[] = $memObject3;

    // ...

    unset($memObject2); // $memObject2 is destroyed here

    // ...
    // $memObject1 is destroyed here
    // but $memObject3 object is still referenced by $memList
    // and is not destroyed
}</code></pre>
<p>This applies to both movable and locked objects.</p>
<h2 id="settings">Settings</h2>
<h3>Memory Limit</h3>
<p>The memory limit is the maximum number of bytes allowed for use by loaded
movable objects.</p>
<p>If loading or creation of an object causes memory usage to exceed of this limit,
then the memory manager swaps some other objects.</p>
<p>You can retrieve or set the memory limit setting using the <code>getMemoryLimit()</code> and
<code>setMemoryLimit($newLimit)</code> methods:</p>
<pre class=codehilite><code class=language-php>$oldLimit = $memoryManager-&gt;getMemoryLimit();  // Get memory limit in bytes
$memoryManager-&gt;setMemoryLimit($newLimit);     // Set memory limit in bytes</code></pre>
<p>A negative value for memory limit means 'no limit'.</p>
<p>The default value is two-thirds of the value of <code>memory_limit</code> in <code>php.ini</code> or
'no limit' (-1) if <code>memory_limit</code> is not set in <code>php.ini</code>.</p>
<h3>MinSize</h3>
<p>The <code>MinSize</code> is the minimum size an object must be before it will be swapped to a
cache backend; objects with sizes smaller than this value will not be swapped.
This reduces the number of swap/load operations.</p>
<p>You can retrieve or set the minimum size using the <code>getMinSize()</code> and
<code>setMinSize($newSize)</code> methods:</p>
<pre class=codehilite><code class=language-php>$oldMinSize = $memoryManager-&gt;getMinSize();  // Get MinSize in bytes
$memoryManager-&gt;setMinSize($newSize);        // Set MinSize limit in bytes</code></pre>
<p>The default minimum size value is 16KB (16384 bytes).</p>




    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../intro/">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../memory-objects/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>




    <div class="help-wanted">
        <p>
            Found a mistake or want to contribute to the documentation?
            <a href="https://github.com/laminas/laminas-memory/edit/master/docs/book/memory-manager.md" target="_blank" class="help-wanted__link">
                Edit this page on GitHub!
            </a>
        </p>
    </div>

                
            </div>
            <div class="col-md-3 col-sm-12 sidebar">
                
                    <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="..">laminas-memory</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../intro/" class="subnavigation__link">Introduction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Reference</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Memory Manager</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../memory-objects/" class="subnavigation__link">Memory Objects</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">
            <div class="col-md-7 offset-md-2">
                <h5>Laminas</h5>
                <ul>
                    <li>Laminas Project <a href="https://getlaminas.org/">The new foundation for the community-supported, open source continuation of Zend Framework</a></li>
                    <li>Laminas Components and MVC <a href="https://docs.laminas.dev/">Components and MVC for enterprise applications</a></li>
                    <li>Mezzio <a href="https://docs.mezzio.dev/">PSR-15 middleware in minutes</a></li>
                    <li>Laminas API Tools <a href="https://api-tools.getlaminas.org/">Build RESTful APIs in minutes</a></li>
                </ul>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-4 offset-md-2">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.laminas.dev" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://laminas.dev/chat" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/laminas" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/getlaminas" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://getlaminas.org/blog/feed-rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://getlaminas.org/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                    </li>
                </ul>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">License</h4>
                <p>
                    Code licensed under <a
                        href="https://github.com/laminas/laminas-memory/blob/master/LICENSE.md">BSD 3-Clause</a>.
                </p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Copyright</h4>
                <p>
                    <!--Built with love by the Laminas team with the help of our
                    <a href="https://github.com/laminas/laminas-memory/graphs/contributors">contributors</a>.<br>-->
                    &copy; 2019-2020 by <a href="https://getlaminas.org/">The Laminas Project</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

    <script>
        let base_url = '..',
            project  = "components",
            siteName = 'laminas-memory';
    </script>
    <script src="https://docs.laminas.dev/js/scripts.js"></script>
        <script src="../search/main.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search in laminas-memory" id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
        </div>
    </div>
</div>
</body>


</html>
